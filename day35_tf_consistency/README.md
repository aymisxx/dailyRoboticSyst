# Day 35: TF Trees & Coordinate Consistency (ROS2)

## Objective
Implement and verify a valid **TF (Transform) tree** in ROS2, focusing purely on
**coordinate-frame consistency** rather than motion, control, or perception
algorithms.

The goal is to ensure that all frames agree on **spatial truth**.

---

## TF Tree Implemented

```
world
 └── base_link
       ├── camera_link
       └── imu_link
```

- `world` → global reference frame.  
- `base_link` → robot body frame.  
- `camera_link`, `imu_link` → rigidly attached sensor frames.  

All transforms used in this exercise are **static**.

## Environment
- OS: Ubuntu 22.04
- ROS2: Humble Hawksbill
- Packages used:
  - `tf2_ros`
  - `tf2_tools`

## Step-by-Step Implementation (Exact Terminal Commands)

### Terminal 1: Publish `world → base_link`

Defines the robot body frame relative to the global frame.

```bash
ros2 run tf2_ros static_transform_publisher 0 0 0 0 0 0 world base_link
```

Arguments:

```
x y z roll pitch yaw parent_frame child_frame
```

### Terminal 2: Publish `base_link → camera_link`
Defines the camera frame rigidly attached to the robot body.

```bash
ros2 run tf2_ros static_transform_publisher 0.2 0 0.15 0 0 0 base_link camera_link
```

### Terminal 3: Publish `base_link → imu_link`

Defines the IMU frame rigidly attached to the robot body.

```bash
ros2 run tf2_ros static_transform_publisher 0.0 0 0.05 0 0 0 base_link imu_link
```

At this stage, the TF tree is fully connected and valid.

## Verification Commands

### 1. Numeric Transform Verification
Verify that chained transforms resolve correctly.

```bash
ros2 run tf2_ros tf2_echo world camera_link
```

Expected behavior:
- Continuous output
- Translation approximately `(0.2, 0, 0.15)`
- Rotation `(0, 0, 0)`

### 2. Generate TF Tree Diagram (Primary Artifact)

```bash
ros2 run tf2_tools view_frames
```

This command generates:
- `frames_YYYY-MM-DD_HH.MM.SS.pdf`
- `frames_YYYY-MM-DD_HH.MM.SS.gv`

These files visualize the TF tree structure and serve as proof of correct
implementation.

### 3. (Optional) Save Numeric Output

```bash
ros2 run tf2_ros tf2_echo world camera_link | head -n 30 > tf_echo.txt
```

## Artifacts Committed

```
day35_tf_consistency/
├── README.md
└── results/
    ├── frames_2026-02-04_13.15.36.pdf
    └── frames_2026-02-04_13.15.36.gv
```

The PDF generated by `view_frames` is the **main verification artifact**.

## Key Learning

TF trees enforce **spatial consistency** across the robotics stack.

Most perception and estimation failures originate from:

- disconnected TF trees.
- multiple parents for a single frame.
- incorrect static transforms.
- inconsistent frame definitions.

Correct TF configuration is a **prerequisite** for perception, estimation,
planning, and control.

## Scope Clarification

This exercise intentionally does **not** include:
- odometry.
- motion.
- SLAM.
- dynamic transforms.

Those require time-varying frames and are addressed later.

## Status

TF tree implemented.  
Transforms verified numerically.  
TF graph generated.  
Commit-ready artifacts produced.  

**Day 35 complete.**

---